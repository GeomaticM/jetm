<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US" xml:lang="en_US">
<head>
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"/>
  <title>Java(TM) Execution Time Measurement Library</title>
  <link rel="stylesheet" type="text/css" href="../default.css"/>
</head>

<body>

<div id="content">
<div id="header">Java&trade; Execution Time Measurement Library</div>

<div id="subheader">The swiss army knife of the poor</div>

<div id="main">
<h3>EtmMonitor JMX Howto</h3>

<p>
  JETM provides means to expose an EtmMonitor through JMX. This page describes the necessary steps
  for manual registration, for Springframework based registration and automatic registration using
  a JETM plugin.
</p>

<p style="color:red">This feature is currently available via <a href="../cvs.html" style="color:red">CVS</a> and
  <a href="../files.html" style="color:red">Snapshot</a> only.
</p>
<h4>JMX support using JETM plugin</h4>

<p>
  Whenever you are using static <a href="etm_manager_configuration.html">EtmManager Configuration</a>
  you can use the <a href="../@api@/etm/core/jmx/EtmMonitorJmxPlugin.html">EtmMonitorJmxPlugin</a> for JMX
  registration.
</p>

<p>
  The following example uses xml based EtmMonitor configuration and alters the
  MBean name to <i>etm:service=PerformanceMonitoringService</i>. If you don't provide this property
  the default name <i>etm:service=PerformanceMonitor</i> will be used.
</p>

<div class="code"><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE jetm-config PUBLIC "-// void.fm //DTD JETM Config 1.0//EN"
                             "http://jetm.void.fm/dtd/jetm_config_1_0.dtd"&gt;
&lt;jetm-config&gt;
  ...
  &lt;extension&gt;
    &lt;plugin&gt;
      &lt;plugin-class&gt;<b>etm.core.jmx.EtmMonitorJmxPlugin</b>&lt;/plugin-class&gt;
      &lt;properties&gt;
        &lt;property name="etmMonitorObjectName"&gt;etm:service=PerformanceMonitoringService&lt;/property&gt;
      &lt;/properties&gt;
    &lt;/plugin&gt;
  &lt;/extension&gt;
&lt;/jetm-config&gt;
</pre>
</div>

<h4>JMX support using manual registration</h4>

<p>
  Of course it is possible to register an EtmMonitor manually. Use the class
  <a href="../@api@/etm/core/jmx/EtmMonitorMBean.html">EtmMonitorMBean</a> to do so.
</p>

<div class="code"><pre>
EtmMonitor monitor = ...;

ArrayList mbeanServers = MBeanServerFactory.findMBeanServer(<span class="java-keyword">null</span>);
MBeanServer mbeanServer = (MBeanServer) mbeanServers.get(0);

<span class="java-keyword">if</span> (mbeanServer != null) {

  ObjectName objectName = new ObjectName("etm:service=PerformanceMonitor");
  <span class="java-quote">// register EtmMonitor using EtmMonitorMBean</span>
  <span class="java-keyword">try</span> {
    mbeanServer.registerMBean(<b>new EtmMonitorMBean(monitor)</b>, objectName);
  }
}
</pre>
</div>

<h4>JMX support using Spring Framework MBeanExporter</h4>

<p>
  If you are using Spring for configuration management you can easily export any EtmMonitor instance
  using the Springframework class <i>MBeanExporter</i>. This class can export valid JMX MBeans to an MBeanServer
  by declaration or automatically.
</p>

<p>
  The following configuration example exports all JMX MBeans including our
  <a href="../@api@/etm/core/jmx/EtmMonitorMBean.html">EtmMonitorMBean</a> using the JMX name
  <i>etm:service=PerformanceMonitor</i>. It assumes that your application runs within an JMX
  enabled infrastructure (such as JBoss, Tomcat or Bea Weblogic). For all other plattforms
  see spring <i>MBeanExporter</i> documentation.
</p>

<div class="code"><pre>&lt;beans&gt;

  &lt;bean id="etmMonitor" class="etm.core.monitor.NestedMonitor"
        init-method="start" destroy-method="stop"/&gt;

  &lt;bean name="etm:service=PerformanceMonitor"
        class="etm.core.jmx.EtmMonitorMBean" autowire="constructor"/&gt;

  &lt;bean class="org.springframework.jmx.export.MBeanExporter"&gt;
    &lt;property name="autodetect" value="true"/&gt;
  &lt;/bean&gt;

&lt;/beans&gt;</pre>
</div>
<h4>Further notes</h4>

<p>
  Accessing performance results via JMX is kind a awkward since everything pretty much depends on your
  JMX browser. For instance the Sun JDK <a href="http://java.sun.com/developer/technicalArticles/J2SE/jconsole.html">JConsole</a>
  will render strange performance results while the JBoss JMX console can be used as a replacement for our
  <a href="drop-in-console.html">JETM HTTP Console</a>.
</p>
</div>
<div id="menu">
  <a href="../index.html">Home</a>
  |
  <a href="../doc.html">Documentation</a>
  |
  <a href="../faq.html">FAQ</a>
  |
  <a href="../@api@/index.html">JavaDoc</a>
  |
  <a href="../files.html">Download</a>
  |
  <a href="../cvs.html">CVS</a>
  |
  <a href="http://sourceforge.net/mail/?group_id=109626">Mailing Lists</a>
  |
  <a href="http://sourceforge.net/projects/jetm/">Sourceforge Project Page</a>
</div>
</div>

</body>
<!-- Last modified  $Date: 2006/10/19 11:54:39 $ -->
</html>