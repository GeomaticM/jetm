<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US" xml:lang="en_US">
<head>
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"/>
  <title>Java(TM) Execution Time Measurement Library</title>
  <link rel="stylesheet" type="text/css" href="../default.css"/>
</head>

<body>

<div id="content">
<div id="header">Java&trade; Execution Time Measurement Library</div>

<div id="subheader">The swiss army knife of the poor</div>

<div id="main">
<h3>JETM: Five minute tutorial</h3>

<p>
  This tutorial demonstrates some advanced features of JETM. It assumes you have
  already taken a look at <a href="advanced_concepts.html">advanced concepts</a>.
  If you are new to JETM better start with <a href="one_minute_tutorial.html">one minute tutorial</a>.
</p>

<p>
  In this tutorial we will enhance a Java&trade; application such that we are able to gain performance statistics without
  touching source code at all. Out of convenience we use the Springframework as runtime and performance
  monitoring infrastructure.
</p>

<p>
  <i>Attention:</i> If you never heard about the Springframework this tutorial may take longer than five minutes.
</p>
<h4>Step 1: Prerequisites</h4>

<p>
  The JETM samples include all required sources for this tutorial. <a href="../files.html">Download</a>
  the archive and expand it. Now there are two options to execute the tutorial demo application:
</p>

<p>
  If you want to run the tutorial from within your favourite IDE just create a new project from the content of
  <i>tutorial/five-minute</i> and ensure that <i>lib/jetm-{VERSION}.jar</i>, <i>lib/jetm-optional-{VERSION}.jar</i>
  and all libraries in <i>tutorial/five-minute/lib</i> are in your project classpath.
</p>

<p>
  Alternatively you can just use <a href="http://ant.apache.org">ANT</a> and run this tutorial from the command line.
  Therefore a valid <i>ANT</i> installation (>= 1.6.x) is required.
</p>

<h4>Step 2: Examine tutorial source code</h4>

<p>
  TBD
</p>
<h4>Step 3: Run the demo</h4>

<p>
  We are now ready to run the demo. Depending on whether you run the demo from your IDE or from command line
  the process is slightly different.
</p>
<table>
  <tr>
    <td valign="top" width="120">IDE Setup</td>
    <td>
      1. Compile the demo in your IDE.<br/>
      2. Execute the main class etm.tutorial.fiveminute.Main.<br/>
      3. Interact with tutorial application.<br/>
    </td>
  </tr>
  <tr>
    <td valign="top">Command line</td>
    <td>
      1. Change directory to <i>tutorial/five-minute</i><br/>
      2. Execute <i>ant demo</i> from the commandline<br/>
      3. Interact with tutorial application.<br/>
    </td>
  </tr>
</table>
<p>
  You should now see at your console the output of our JETM Grocery Store:
</p>

<div class="code"><pre>Welcome to the JETM Grocery Store!

We currently have in stock:
 ------------------------------
 | ID | Qty | Item    | Price |
 ------------------------------
 |  1 |  15 |  apples | $2.99 |
 |  2 |   5 | oranges | $1.49 |
 |  3 |  20 | bananas | $1.99 |
 |  4 |  11 |  grapes | $2.49 |
 ------------------------------

Enter item id to order (or 0 exit): 
</pre>
</div>
<h4>Step 4: Add performance monitoring</h4>

<p>
  The application itself isn't that impressive. However it's only purpose is to demonstrate performance monitioring.


</p>

<p>
  Your should now enable the following XML fragement in your tutorial spring configuration (<i>five-minute-tutorial.xml</i>).
</p>

<div class="code"><pre>&lt;!-- Step 4: Add performance monitoring --&gt;
  
&lt;bean id="etmMonitor" class="<b>etm.core.monitor.NestedMonitor</b>"
      init-method="start" destroy-method="stop"/&gt;

&lt;bean id="etmMethodCallInterceptor" class="<b>etm.contrib.aop.aopalliance.EtmMethodCallInterceptor</b>"
      autowire="constructor"/&gt;

&lt;bean id="etmAutoProxy"
      class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator"&gt;
      &lt;property name="interceptorNames"&gt;
        &lt;list&gt;
          &lt;value&gt;etmMethodCallInterceptor&lt;/value&gt;
        &lt;/list&gt;
      &lt;/property&gt;
      &lt;property name="beanNames"&gt;
        &lt;list&gt;
          &lt;value&gt;<b>orderAgent</b>&lt;/value&gt;
          &lt;value&gt;<b>*Dao</b>&lt;/value&gt;
        &lt;/list&gt;
      &lt;/property&gt;
&lt;/bean&gt;</pre>
</div>


<h4>Step 5: Access aggregated results</h4>

<p>
  There isn't much.
</p>

<div class="code"><pre>&lt;bean id="etmHttpConsole" class="<b>etm.contrib.console.HttpConsoleServer</b>"
      init-method="start" destroy-method="stop" autowire="constructor"&gt;
      &lt;property name="expanded" value="true" /&gt;
&lt;/bean&gt;  
</pre>
</div>
<p>
  Now restart the tutorial and point your browser to <a href="http://localhost:40000">http://localhost:40000</a>
  to access the aggregated performance statistics provided by the build-in
  <a href="../howto/drop-in-console.html">HTTP console</a>
</p>

<h4>Step 6: Alter aggregation chain</h4>

<div class="code"><pre>&lt;bean id="etmMonitor" class="<b>etm.core.monitor.NestedMonitor</b>"
      init-method="start" destroy-method="stop"&gt;
      &lt;constructor-arg ref="<b>aggregatorChain</b>"/&gt;
&lt;/bean&gt;

&lt;bean id="aggregatorChain" class="<b>etm.core.aggregation.BufferedTimedAggregator</b>"&gt;
      &lt;constructor-arg&gt;
        &lt;bean class="<b>etm.core.aggregation.NestedAggregator</b>"/&gt;
      &lt;/constructor-arg&gt;
      &lt;property name="aggregationInterval" value="1000" /&gt;
&lt;/bean&gt;</pre>
</div>


<h4>Step 7: Log raw performance results</h4>

<div class="code"><pre>&lt;bean id="etmMonitor" class="<b>etm.core.monitor.NestedMonitor</b>"
      init-method="start" destroy-method="stop"&gt;
      &lt;constructor-arg ref="<b>aggregatorChain</b>"/&gt;
&lt;/bean&gt;

&lt;bean id="aggregatorChain" class="<b>etm.core.aggregation.BufferedTimedAggregator</b>"&gt;
      &lt;constructor-arg&gt;
        &lt;bean class="<b>etm.contrib.aggregation.log.CommonsLoggingAggregator</b>"&gt;
          &lt;constructor-arg&gt;
            &lt;bean class="<b>etm.core.aggregation.NestedAggregator</b>"/&gt;
          &lt;/constructor-arg&gt;
        &lt;/bean&gt;
      &lt;/constructor-arg&gt;
&lt;/bean&gt;</pre>
</div>

<h4>Next...</h4>

<p>Now proceed to remaining <a href="../doc.html">JETM documentation</a>.
</p>
</div>

<div id="menu">
  <a href="../index.html">Home</a>
  |
  <a href="../doc.html">Documentation</a>
  |
  <a href="../faq.html">FAQ</a>
  |
  <a href="../@api@/index.html">JavaDoc</a>
  |
  <a href="../files.html">Download</a>
  |
  <a href="../svn.html">SVN</a>
  |
  <a href="http://sourceforge.net/mail/?group_id=109626">Mailing Lists</a>
  |
  <a href="http://sourceforge.net/projects/jetm/">Sourceforge Project Page</a>
</div>
</div>

</body>
<!-- Last modified  $Date$ -->
</html>